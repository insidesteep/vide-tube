"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{558:function(e,t,r){r.r(t),r.d(t,{generateDocument:function(){return y},getQrCodeImg:function(){return h}});var n=r(4522),o=r.n(n),a=r(1344),s=r.n(a),i=r(2294),p=r.n(i),l=r(3162),c=r(1440),f=r.n(c),g=r(2592),u=r(902),m=r(8764).lW;let d=/^data:image\/(png|jpg|svg|svg\+xml);base64,/,w={getImage:e=>(function(e){if("string"!=typeof e||!d.test(e))return!1;let t=e.replace(d,"");if(void 0!==m&&m.from)return m.from(t,"base64");let r=window.atob(t),n=r.length,o=new Uint8Array(n);for(let a=0;a<n;a++){let s=r.charCodeAt(a);o[a]=s}return o.buffer})(e),getSize:()=>[100,100]},b=(e,t)=>{p().getBinaryContent(e,t)},y=e=>{b("".concat(u.appUrl,"/files/doc-template.docx"),(t,r)=>{if(t)throw t;let n=new(s())(r),a=new(o())(n,{paragraphLoop:!0,linebreaks:!0,modules:[new(f())(w)]});a.setData(e);try{a.render()}catch(c){let i=(e,t)=>t instanceof Error?Object.getOwnPropertyNames(t).reduce((e,r)=>(c[r]=t[r],c),{}):t;if(console.log(JSON.stringify({error:c},i)),c.properties&&c.properties.errors instanceof Array){let p=c.properties.errors.map(e=>e.properties.explantion).join("\n");console.log("errorMessages",p)}throw c}let g=a.getZip().generate({type:"blob",mimeTye:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});(0,l.saveAs)(g,"output.docx")})},h=async e=>{let t=await g.toDataURL(e);return t}}}]);