(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[142],{3275:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/addVideo",function(){return t(5409)}])},5409:function(e,s,t){"use strict";t.r(s),t.d(s,{__N_SSP:function(){return j},default:function(){return v}});var a=t(5893),i=t(381),l=t.n(i),n=t(7294);t(1955);let{useRef:c,useCallback:r}=t(7294),o=(e,s)=>{let t=c(null),a=r(function(){for(var a=arguments.length,i=Array(a),l=0;l<a;l++)i[l]=arguments[l];t.current&&clearTimeout(t.current),t.current=setTimeout(()=>{e(...i)},s)},[e,s]);return a};var d=t(902),u=t.n(d);let{appUrl:h,serverPort:m}=u(),p=e=>{let s=/([0-9]*H)?([0-9]*M)?([0-9]*S)?$/.exec(e),t=parseInt(s[1],10)||0,a=parseInt(s[2],10)||0,i=parseInt(s[3],10)||0;return 36e5*t+6e4*a+1e3*i},x=e=>{let{playlists:s,authors:t}=e,[i,c]=(0,n.useState)(t),[r,u]=(0,n.useState)(""),[m,x]=(0,n.useState)(""),[j,v]=(0,n.useState)(null),[N,g]=(0,n.useState)(""),[f,b]=(0,n.useState)(""),w=o(async()=>{let e="".concat(h,"/api/authors");console.log(h,e);try{m.length>1&&(e="".concat(h,"/api/authors?search=").concat(m)),console.log(h,e);let s=await fetch(e),t=await s.json();t.success&&c(t.data)}catch(a){alert("Ошибка запроса")}},500);(0,n.useEffect)(()=>{w()},[m]),(0,n.useEffect)(()=>{i&&i.authors&&i.authors.length&&g(i.authors[0]._id)},[i]),(0,n.useEffect)(()=>{s&&s.items&&s.items.length&&b(s.items[0].id)},[s]);let y=e=>{u(e.target.value)},_=async()=>{try{let e=await fetch("".concat("https://www.googleapis.com/youtube/v3","/videos?part=snippet,statistics,contentDetails&id=").concat(r,"&key=").concat(d.youtubeApiKey)),s=await e.json();s.items&&s.items.length?v(s.items[0]):alert("Ничего не найдено)")}catch(t){alert("Ошибка)")}},C=e=>{b(e.target.value)},S=e=>{g(e.target.value)},E=async()=>{try{let e=s.items.find(e=>e.id==f),t=await fetch("".concat(h,"/api/videos"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:j.snippet.title,description:j.snippet.description,thumbnail:j.snippet.thumbnails.default.url,youtubeId:j.id,viewCount:j.statistics.viewCount,duration:l()(p(j.contentDetails.duration)).format("mm:ss"),author:N,category:{name:e.snippet.title,playlistId:e.id}})}),a=await t.json();alert(a.message)}catch(i){alert("Ошибка при сохранении видео")}};return(0,a.jsxs)("div",{className:"container-fluid upload-details",children:[(0,a.jsxs)("div",{className:"row",children:[(0,a.jsx)("div",{className:"col-lg-12",children:(0,a.jsx)("div",{className:"main-title",children:(0,a.jsx)("h6",{children:"Детали видео"})})}),j&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"col-lg-2",children:(0,a.jsx)("div",{className:"imgplace",children:(0,a.jsx)("img",{src:j.snippet.thumbnails.default.url,width:"100%"})})}),(0,a.jsxs)("div",{className:"col-lg-10",children:[(0,a.jsx)("div",{className:"osahan-title",children:j.snippet.title}),(0,a.jsx)("div",{className:"osahan-size",children:"Продолжительность: 2:13 мин . Просмотров: 2"}),(0,a.jsx)("div",{className:"osahan-progress",children:"Описание:"}),(0,a.jsx)("div",{className:"osahan-desc",children:j.snippet.description})]})]})]}),(0,a.jsx)("hr",{}),(0,a.jsx)("div",{className:"row",children:(0,a.jsxs)("div",{className:"col-lg-12",children:[(0,a.jsxs)("div",{className:"osahan-form",children:[(0,a.jsx)("div",{className:"row",children:(0,a.jsx)("div",{className:"col-lg-12",children:(0,a.jsxs)("div",{className:"form-group ",children:[(0,a.jsx)("label",{htmlFor:"e1",children:"Поиск по YouTube ID"}),(0,a.jsxs)("div",{className:"d-flex alig-items-center",children:[(0,a.jsx)("input",{onChange:y,value:r,type:"text",placeholder:"Введите id видео",id:"e1",className:"form-control"}),(0,a.jsx)("button",{className:"btn btn-primary btn-sm",disabled:!r,onClick:_,children:"Поиск"})]})]})})}),(0,a.jsxs)("div",{className:"row",children:[(0,a.jsx)("div",{className:"col-lg-6",children:(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"e3",children:"Категория"}),(0,a.jsx)("select",{id:"e3",className:"custom-select",value:f,onChange:C,children:s&&s.items.map(e=>(0,a.jsx)("option",{value:e.id,children:e.snippet.title},e.id))})]})}),(0,a.jsx)("div",{className:"col-lg-6",children:(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{htmlFor:"e4",children:"Автор"}),(0,a.jsxs)("div",{className:"input-group mb-3",children:[(0,a.jsx)("select",{id:"e4",className:"custom-select",value:N,onChange:S,children:i&&i.authors.map(e=>(0,a.jsx)("option",{value:e._id,children:"".concat(e.lastname," ").concat(e.firstname," ").concat(e.patronymic)},e._id))}),(0,a.jsx)("input",{onChange:e=>x(e.target.value),value:m,type:"text",placeholder:"Введите имя автора",id:"e1",className:"form-control"})]})]})})]})]}),(0,a.jsx)("div",{className:"osahan-area text-center mt-3",children:(0,a.jsx)("button",{className:"btn btn-outline-primary",onClick:E,disabled:!j,children:"Сохранить"})}),(0,a.jsx)("hr",{})]})})]})};var j=!0,v=x}},function(e){e.O(0,[885,774,888,179],function(){return e(e.s=3275)}),_N_E=e.O()}]);